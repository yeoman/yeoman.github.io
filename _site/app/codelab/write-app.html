<h1>Step 6: Start writing our AngularJS application</h1>

<p>The files that you see in the web browser can be found in the <strong><em>app</em></strong> subfolder of your <strong><em>mytodo</em></strong> directory. All the instructions in this section assume that you are editing files in this <em>app</em> folder.  If you are unsure about any of the changes you should be doing, refer to the <a href="../codelab.html#source-files">final source code</a>.</p>

<h2>Create a new template to show a todo list</h2>

<p>Open <strong><em>views/main.html</em></strong>.</p>

<p>To start from a cleaner slate, delete everything from your <em>main.html</em> file except for the <code>div</code> with a class of <code>&quot;jumbotron&quot;</code>. Replace <code>&quot;jumbotron&quot;</code> with the class name <code>&quot;container&quot;</code>.</p>

<p>This is all you should have in <em>main.html</em> now:</p>
<div class="highlight"><pre><code class="html language-html" data-lang="html"><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;container&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</code></pre></div>
<p>Open <strong><em>scripts/controllers/main.js</em></strong>.</p>

<p>Modify this boilerplate Angular Controller to contain a list of <code>todos</code> instead of <code>awesomeThings</code>:</p>
<div class="highlight"><pre><code class="js language-js" data-lang="js"><span class="s1">&#39;use strict&#39;</span><span class="p">;</span>

<span class="nx">angular</span><span class="p">.</span><span class="nx">module</span><span class="p">(</span><span class="s1">&#39;mytodoApp&#39;</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">controller</span><span class="p">(</span><span class="s1">&#39;MainCtrl&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">$scope</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">$scope</span><span class="p">.</span><span class="nx">todos</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Item 1&#39;</span><span class="p">,</span> <span class="s1">&#39;Item 2&#39;</span><span class="p">,</span> <span class="s1">&#39;Item 3&#39;</span><span class="p">];</span>
  <span class="p">});</span>
</code></pre></div>
<p>Then modify our view (<em>main.html</em>) to output our todos items as HTML text <code>input</code> fields:</p>
<div class="highlight"><pre><code class="html language-html" data-lang="html"><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;container&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;h2&gt;</span>My todos<span class="nt">&lt;/h2&gt;</span>
  <span class="nt">&lt;p</span> <span class="na">class=</span><span class="s">&quot;form-group&quot;</span> <span class="na">ng-repeat=</span><span class="s">&quot;todo in todos&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">ng-model=</span><span class="s">&quot;todo&quot;</span> <span class="na">class=</span><span class="s">&quot;form-control&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;/p&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</code></pre></div>
<p>The <a href="http://docs.angularjs.org/api/ng.directive:ngRepeat"><code>ng-repeat</code></a> attribute on the paragraph tag is an Angular <a href="http://docs.angularjs.org/guide/directive">directive</a> that instantiates a template once per item from a collection.</p>

<p>In our case, imagine that the paragraph element and its content is turned into a virtual rubber stamp by adding the <code>ng-repeat</code> attribute. For each item in the <code>todos</code> array, Angular will stamp out a new instance of the <code>&lt;p&gt;&lt;input&gt;&lt;/p&gt;</code> HTML block.</p>

<p>The <a href="http://docs.angularjs.org/api/ng.directive:ngModel"><code>ng-model</code></a> attribute is another Angular directive that works with <code>input</code>, <code>select</code>, <code>textarea</code>, and custom directives to create a <a href="http://docs.angularjs.org/guide/databinding">two-way data binding</a>. In our example, it populates a text <code>input</code> field with the value from the current <code>todo</code> item in the <code>ng-repeat</code> loop.</p>

<p>Let&#39;s see <code>ng-repeat</code> and <code>ng-model</code> in action within the browser. Upon saving, our application should now look like this:</p>

<p><img src="/assets/img/codelab/image_15.png" alt=""></p>

<p>Manually update <code>$scope.todos</code> with a fourth todo item:</p>
<div class="highlight"><pre><code class="js language-js" data-lang="js"><span class="nx">$scope</span><span class="p">.</span><span class="nx">todos</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Item 1&#39;</span><span class="p">,</span> <span class="s1">&#39;Item 2&#39;</span><span class="p">,</span> <span class="s1">&#39;Item 3&#39;</span><span class="p">,</span> <span class="s1">&#39;Item 4&#39;</span><span class="p">];</span>
</code></pre></div>
<p>With live reload, you should see the new todo item appear in the list.</p>

<p>Manually remove the fourth item and watch it disappear from the list.</p>

<h2>Add a todo</h2>

<p>Let’s implement a way for the user to add new todo items to the list.</p>

<p>Modify <em>main.html</em> by adding a <code>form</code> element in between the <code>&lt;h2&gt;</code> and <code>&lt;p&gt;</code> elements from the previous section. Your <em>main.html</em> should now look like this:</p>
<div class="highlight"><pre><code class="html language-html" data-lang="html"><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;container&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;h2&gt;</span>My todos<span class="nt">&lt;/h2&gt;</span>

  <span class="c">&lt;!-- Todos input --&gt;</span>
  <span class="nt">&lt;form</span> <span class="na">role=</span><span class="s">&quot;form&quot;</span> <span class="na">ng-submit=</span><span class="s">&quot;addTodo()&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;row&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;input-group&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">ng-model=</span><span class="s">&quot;todo&quot;</span> <span class="na">placeholder=</span><span class="s">&quot;What needs to be done?&quot;</span> <span class="na">class=</span><span class="s">&quot;form-control&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">&quot;input-group-btn&quot;</span><span class="nt">&gt;</span>
          <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;submit&quot;</span> <span class="na">class=</span><span class="s">&quot;btn btn-primary&quot;</span> <span class="na">value=</span><span class="s">&quot;Add&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;/span&gt;</span>
      <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/form&gt;</span>
  <span class="nt">&lt;p&gt;&lt;/p&gt;</span>

  <span class="c">&lt;!-- Todos list --&gt;</span>
  <span class="nt">&lt;p</span> <span class="na">class=</span><span class="s">&quot;form-group&quot;</span> <span class="na">ng-repeat=</span><span class="s">&quot;todo in todos&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">ng-model=</span><span class="s">&quot;todo&quot;</span> <span class="na">class=</span><span class="s">&quot;form-control&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;/p&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</code></pre></div>
<p>This adds a HTML form with a submit button to the top of the page. It utilises another Angular directive, <a href="http://docs.angularjs.org/api/ng.directive:ngSubmit"><code>ng-submit</code></a> which we’ll get to next. Return to your browser and the UI should now look similar to this:</p>

<p><img src="/assets/img/codelab/image_16.png" alt=""></p>

<p>If you click <strong>Add</strong> currently, nothing will happen &mdash; let’s change that.</p>

<p><code>ng-submit</code> binds an Angular expression to the onsubmit event of the form. If no action attribute is applied to the form, it also prevents the default browser behaviour. In our example we’ve added an Angular expression of <code>addTodo()</code>.</p>

<p>The following <code>addTodo()</code> function pushes new todo items onto the existing todo items array and then clears the text input field:</p>
<div class="highlight"><pre><code class="js language-js" data-lang="js"><span class="nx">$scope</span><span class="p">.</span><span class="nx">addTodo</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="nx">$scope</span><span class="p">.</span><span class="nx">todos</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">$scope</span><span class="p">.</span><span class="nx">todo</span><span class="p">);</span>
  <span class="nx">$scope</span><span class="p">.</span><span class="nx">todo</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
<span class="p">};</span>
</code></pre></div>
<p>Edit <em>main.js</em> by adding the <code>addTodo()</code> function within the <code>MainCtrl</code> controller definition. Your complete controller should look like this:</p>
<div class="highlight"><pre><code class="js language-js" data-lang="js"><span class="s1">&#39;use strict&#39;</span><span class="p">;</span>

<span class="nx">angular</span><span class="p">.</span><span class="nx">module</span><span class="p">(</span><span class="s1">&#39;mytodoApp&#39;</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">controller</span><span class="p">(</span><span class="s1">&#39;MainCtrl&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">$scope</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">$scope</span><span class="p">.</span><span class="nx">todos</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Item 1&#39;</span><span class="p">,</span> <span class="s1">&#39;Item 2&#39;</span><span class="p">,</span> <span class="s1">&#39;Item 3&#39;</span><span class="p">];</span>
    <span class="nx">$scope</span><span class="p">.</span><span class="nx">addTodo</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
      <span class="nx">$scope</span><span class="p">.</span><span class="nx">todos</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">$scope</span><span class="p">.</span><span class="nx">todo</span><span class="p">);</span>
      <span class="nx">$scope</span><span class="p">.</span><span class="nx">todo</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
    <span class="p">};</span>
  <span class="p">});</span>
</code></pre></div>
<div class="note tip">
Note: If you encounter linting errors in the command line window, this may be due to indentation warnings being thrown from <a href="http://www.jshint.com/">jshint</a>. They are only warnings so your todo app will continue to work. However, do look at the suggestions made from jshint and adjust your code accordingly for clean and readable code.
</div>

<p>View the app in the browser again. Type some text in the input field for a new todo item and hit <strong>Add</strong>. It will be immediately reflected in your todos list!</p>

<div class="side-by-side">
  <img src="/assets/img/codelab/image_17.png">
  <img src="/assets/img/codelab/image_18.png">
</div>

<div class="note important">
Note: If you enter in more than one blank todo item, or a todo item with the same name, your todo app will unexpectedly stop working. :( As a fun exercise on your own time, enhance the <code>addTodo()</code> function with error checking.
</div>

<h2>Remove a todo</h2>

<p>Let’s now add the ability to remove a todo item. We’ll need to add a new remove button alongside each todo item.</p>

<p>Going back to our view template (<em>main.html</em>), add a button to the existing <code>ng-repeat</code> directive. And to make sure our input field and remove button line up nicely, change the class on the paragraph tag from <code>&quot;form-group&quot;</code> to <code>&quot;input-group&quot;</code>.</p>

<p>Previous markup:</p>
<div class="highlight"><pre><code class="html language-html" data-lang="html"><span class="c">&lt;!-- Todos list --&gt;</span>
<span class="nt">&lt;p</span> <span class="na">class=</span><span class="s">&quot;form-group&quot;</span> <span class="na">ng-repeat=</span><span class="s">&quot;todo in todos&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">ng-model=</span><span class="s">&quot;todo&quot;</span> <span class="na">class=</span><span class="s">&quot;form-control&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;/p&gt;</span>
</code></pre></div>
<p>New markup:</p>
<div class="highlight"><pre><code class="html language-html" data-lang="html"><span class="c">&lt;!-- Todos list --&gt;</span>
<span class="nt">&lt;p</span> <span class="na">class=</span><span class="s">&quot;input-group&quot;</span> <span class="na">ng-repeat=</span><span class="s">&quot;todo in todos&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">ng-model=</span><span class="s">&quot;todo&quot;</span> <span class="na">class=</span><span class="s">&quot;form-control&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">&quot;input-group-btn&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;button</span> <span class="na">class=</span><span class="s">&quot;btn btn-danger&quot;</span> <span class="na">ng-click=</span><span class="s">&quot;removeTodo($index)&quot;</span> <span class="na">aria-label=</span><span class="s">&quot;Remove&quot;</span><span class="nt">&gt;</span>X<span class="nt">&lt;/button&gt;</span>
  <span class="nt">&lt;/span&gt;</span>
<span class="nt">&lt;/p&gt;</span>
</code></pre></div>
<p>Have a look at your browser. Your todo app is looking snazzy!</p>

<p><img src="/assets/img/codelab/image_19.png" alt=""></p>

<p>We introduced a new Angular directive above, <a href="http://docs.angularjs.org/api/ng.directive:ngClick"><code>ng-click</code></a>. <code>ng-click</code> allows you to specify custom behaviours when an element is clicked. In this instance, we call <code>removeTodo()</code> and pass <code>$index</code> to the function.</p>

<p>The value of <code>$index</code> will be the array index of the current <code>todo</code> item within the <code>ng-repeat</code> directive. For example, the first item will have an array index of 0 and <code>removeTodo()</code> will be passed the value of 0. Similarly, the last item of a todo list with 5 items will have an array index of 4 and <code>removeTodo()</code> will be passed a value of 4.</p>

<p>Let’s now add some logic for removing todo items to our controller. The following <code>removeTodo()</code> function removes one todo item from the items array using the JavaScript <code>splice()</code> method at the given <code>$index</code> value:</p>
<div class="highlight"><pre><code class="js language-js" data-lang="js"><span class="nx">$scope</span><span class="p">.</span><span class="nx">removeTodo</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">index</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">$scope</span><span class="p">.</span><span class="nx">todos</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="nx">index</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="p">};</span>
</code></pre></div>
<p>The complete controller (<em>main.js</em>) with the new <code>removeTodo()</code> function is below:</p>
<div class="highlight"><pre><code class="js language-js" data-lang="js"><span class="s1">&#39;use strict&#39;</span><span class="p">;</span>

<span class="nx">angular</span><span class="p">.</span><span class="nx">module</span><span class="p">(</span><span class="s1">&#39;mytodoApp&#39;</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">controller</span><span class="p">(</span><span class="s1">&#39;MainCtrl&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">$scope</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">$scope</span><span class="p">.</span><span class="nx">todos</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Item 1&#39;</span><span class="p">,</span> <span class="s1">&#39;Item 2&#39;</span><span class="p">,</span> <span class="s1">&#39;Item 3&#39;</span><span class="p">];</span>
    <span class="nx">$scope</span><span class="p">.</span><span class="nx">addTodo</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
      <span class="nx">$scope</span><span class="p">.</span><span class="nx">todos</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">$scope</span><span class="p">.</span><span class="nx">todo</span><span class="p">);</span>
      <span class="nx">$scope</span><span class="p">.</span><span class="nx">todo</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
    <span class="p">};</span>
    <span class="nx">$scope</span><span class="p">.</span><span class="nx">removeTodo</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">index</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">$scope</span><span class="p">.</span><span class="nx">todos</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="nx">index</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="p">};</span>
  <span class="p">});</span>
</code></pre></div>
<p>Back in the browser, you can now hit the <strong>X</strong> button to remove the item from the todo list. Fantastic!</p>

<div class="side-by-side">
  <img src="/assets/img/codelab/image_20.png">
  <img src="/assets/img/codelab/image_21.png">
</div>

<p>One thing you might notice is that we don’t have a way to persist our todo list. Any time we refresh the page our todo items are reset back to the defaults in our <code>todos</code> array hardcoded in <em>main.js</em>. Don’t worry, we’ll fix this in <a href="local-storage.html">Step 10</a> after we learn more about installing packages with Bower next in <a href="install-packages.html">Step 7</a>.</p>

<p class="codelab-paging">
  <a href="../codelab.html#toc">&laquo; Return to overview</a>
  or
  <a href="install-packages.html">Go to the next step &raquo;</a>
</p>
